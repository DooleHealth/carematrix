{"version":3,"sources":["webpack:///src/app/pages/user/settings/settings.page.html","webpack:///src/app/pages/user/settings/settings.page.ts","webpack:///src/app/pages/user/settings/settings-routing.module.ts","webpack:///src/app/pages/user/settings/settings.module.ts","webpack:///src/app/pages/user/settings/settings.page.scss"],"names":["Storage","SettingsPage","translate","authService","faio","notification","backgroundImage","isAvailable","then","res","get","key","setting","hasBiometricAuth","value","undefined","console","log","isBioAuthAvailable","enabled","String","showFingerprintAuthDlg","set","showSuccess","instant","e","hashStr","Date","now","toString","credentials","mutua","credencial","username","validateCredentials","subscribe","data","error","result","show","cancelButtonTitle","title","fallbackButtonTitle","registerBiometrics","code","setTimeout","selector","template","routes","path","component","SettingsPageRoutingModule","imports","forChild","exports","SettingsPageModule","declarations"],"mappings":"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","file":"user-settings-settings-module-es5.js","sourcesContent":["export default \"<!--\\n  Generated template for the LockscreenPage page.\\n\\n  See http://ionicframework.com/docs/components/#navigation for more info on\\n  Ionic pages and navigation.\\n-->\\n<custom-header></custom-header>\\n<ion-content class=\\\"back\\\" [ngStyle]=\\\"{'background': 'url(' + backgroundImage + ')'}\\\" fullscreen>\\n  <page-header title=\\\"{{'side-menu.settings' | translate}}\\\" [icon]=\\\"'assets/icons/i_configuracio.svg'\\\">\\n  </page-header>\\n  <div class=\\\"main-container\\\">\\n    <ion-item>\\n      <ion-label>{{'biometrics.auth' | translate}}</ion-label>\\n      <ion-toggle slot=\\\"start\\\" name=\\\"blueberry\\\" [(ngModel)]=\\\"this.hasBiometricAuth\\\" [disabled]=\\\"this.isBioAuthAvailable\\\" [checked]=\\\"this.hasBiometricAuth != 'false' ? true : false\\\" (ngModelChange)=\\\"setBioAuth(ioToggle.checked)\\\" #ioToggle></ion-toggle>\\n    </ion-item>\\n  </div>\\n\\n</ion-content>\\n\";","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Plugins } from '@capacitor/core';\nimport { FingerprintAIO } from '@ionic-native/fingerprint-aio/ngx';\nimport { TranslateService } from '@ngx-translate/core';\nimport { AuthenticationService } from 'src/app/services/authentication.service';\nimport { NotificationService } from 'src/app/services/notification.service';\nimport { getRandomBackground } from 'src/app/shared/classes/utils';\nimport {Md5} from 'ts-md5/dist/md5';\nconst { Storage } = Plugins;\n\n@Component({\n  selector: 'app-settings',\n  templateUrl: './settings.page.html',\n  styleUrls: ['./settings.page.scss'],\n})\nexport class SettingsPage implements OnInit {\n  hasBiometricAuth : any;\n  backgroundImage: string = getRandomBackground();\n  isBioAuthAvailable:string;\n  constructor(public translate: TranslateService, private authService: AuthenticationService, private faio : FingerprintAIO, private notification: NotificationService) { }\n\n  async ngOnInit() {\n   \n  }\n\n  async ionViewDidEnter(){\n    this.faio.isAvailable().then(async (res)=>{\n      \n      let setting = await Storage.get({ key: 'settings-bio' } );\n      this.hasBiometricAuth = setting.value != undefined && setting.value != 'false';\n      console.log('res: ', res);\n\n    }).catch(()=>{\n      this.isBioAuthAvailable = 'disabled';\n      console.log('Bio Auth: ', this.isBioAuthAvailable);\n    \n    })\n   \n  }\n  async setBioAuth(enabled){\n    console.log('settings-bio', String(enabled));\n\n    if(enabled){\n      this.showFingerprintAuthDlg();\n    }else{\n      this.hasBiometricAuth = false;\n      await Storage.set({\n        key: 'settings-bio',\n        value: 'false'\n      });\n      this.notification.showSuccess(this.translate.instant('ElementsPage.textcorrect'));\n    }\n  \n  }\n\n  async registerBiometrics(){\n\n    let e = Md5.hashStr(Date.now().toString()).toString();\n\n    let credentials = {\n      mutua: this.authService.mutua,\n      credencial:\"biometric\",\n      username: e\n    }\n\n    this.authService.validateCredentials(credentials, 'credencial2').subscribe(\n      async (data) => {\n      \n        console.log(data);\n        await Storage.set({\n          key: 'bio-auth',\n          value: e\n        });\n       \n        await Storage.set({\n          key: 'settings-bio',\n          value: 'true'\n        });\n\n        this.notification.showSuccess(this.translate.instant('ElementsPage.textcorrect'));\n      },\n      (error) => {\n        // Called when error\n        throw error;\n      });   \n  }\n\n  public showFingerprintAuthDlg() {\n\n    this.faio.isAvailable().then((result: any) => {\n      console.log(result)\n\n      this.faio.show({\n        cancelButtonTitle: this.translate.instant('face-id.cancel'),\n        title: this.translate.instant('face-id.title'),\n        fallbackButtonTitle: this.translate.instant('face-id.fallback')\n      })\n        .then(async (result: any) => {\n        \n          this.registerBiometrics();\n         \n        })\n        .catch((error: any) => {\n          this.hasBiometricAuth  = false;\n          console.log(error);\n          if(error.code == -102){\n            setTimeout(()=>this.showFingerprintAuthDlg(), 500);\n          }\n        });\n    })\n    .catch((error: any) => {\n      console.log(error)\n    });\n  }\n}\n\n  ","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SettingsPage } from './settings.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SettingsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SettingsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { IonicModule } from '@ionic/angular';\nimport { SettingsPageRoutingModule } from './settings-routing.module';\nimport { SettingsPage } from './settings.page';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { ComponentsModule } from 'src/app/components/components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SettingsPageRoutingModule,\n    TranslateModule,\n    ComponentsModule,\n  ],\n  declarations: [SettingsPage]\n})\nexport class SettingsPageModule {}\n","export default \".logo-header {\\n  width: 170px;\\n  height: auto;\\n  display: block;\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n\\n.header-one {\\n  --background: rgba(255, 255, 255, 0.9);\\n  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);\\n}\\n\\n.lock-img {\\n  height: auto !important;\\n  width: auto !important;\\n  align-items: center;\\n}\\n\\nion-icon {\\n  font-size: 90px;\\n  color: #006172;\\n  text-align: center;\\n  position: relative;\\n  top: calc(50% - 10px);\\n  /* 50% - 3/4 of icon height */\\n}\\n\\n#container * {\\n  margin: 0;\\n  padding: 0;\\n}\\n\\n#container {\\n  width: 100%;\\n  font-size: 0;\\n}\\n\\n#left,\\n#middle,\\n#right {\\n  display: inline-block;\\n  *display: inline;\\n  zoom: 1;\\n  vertical-align: top;\\n}\\n\\n#left {\\n  width: 25%;\\n}\\n\\n#middle {\\n  vertical-align: bottom;\\n  width: 60%;\\n}\\n\\n#right {\\n  vertical-align: bottom;\\n  width: 15%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NldHRpbmdzLnBhZ2Uuc2NzcyIsInNldHRpbmdzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7RUFFQSxZQUFBO0VBQ0EsY0FBQTtFQUNBLGlCQUFBO0VBQ0Esa0JBQUE7QUFBSjs7QUFFRTtFQUNFLHNDQUFBO0VBQ0EsNEVBQUE7QUFDSjs7QUFFRTtFQUNFLHVCQUFBO0VBQ0Esc0JBQUE7RUFDQSxtQkFBQTtBQUNKOztBQUNFO0VBRUksZUFBQTtFQUNBLGNBQUE7RUFDQSxrQkFBQTtFQUNBLGtCQUFBO0VBQ0EscUJBQUE7RUFBdUIsNkJBQUE7QUFFN0I7O0FBRUU7RUFDSSxTQUFBO0VBQ0EsVUFBQTtBQUNOOztBQUNJO0VBQ0UsV0FBQTtFQUNBLFlBQUE7QUFFTjs7QUFBSTs7O0VBR0UscUJBQUE7R0NHSixlREZJO0VBQ0EsT0FBQTtFQUNBLG1CQUFBO0FBR047O0FBREk7RUFDRSxVQUFBO0FBSU47O0FBRkk7RUFDRSxzQkFBQTtFQUNBLFVBQUE7QUFLTjs7QUFISTtFQUNFLHNCQUFBO0VBQ0EsVUFBQTtBQU1OIiwiZmlsZSI6InNldHRpbmdzLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5sb2dvLWhlYWRlciB7XG4gICAgd2lkdGg6IDE3MHB4O1xuICBcbiAgICBoZWlnaHQ6IGF1dG87XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gICAgbWFyZ2luLXJpZ2h0OiBhdXRvO1xuICB9XG4gIC5oZWFkZXItb25lIHtcbiAgICAtLWJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcbiAgICBib3gtc2hhZG93OiAwIDRweCA4cHggMCByZ2JhKDAsIDAsIDAsIDAuMiksIDAgNnB4IDIwcHggMCByZ2JhKDAsIDAsIDAsIDAuMTkpO1xuICB9XG4gIFxuICAubG9jay1pbWcge1xuICAgIGhlaWdodDogYXV0byAhaW1wb3J0YW50O1xuICAgIHdpZHRoOiBhdXRvICFpbXBvcnRhbnQ7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgfVxuICBpb24taWNvbiB7XG4gICAgICBcbiAgICAgIGZvbnQtc2l6ZTogOTBweDtcbiAgICAgIGNvbG9yOiAgIzAwNjE3MjsgXG4gICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICBwb3NpdGlvbjpyZWxhdGl2ZTtcbiAgICAgIHRvcDogY2FsYyg1MCUgLSAxMHB4KTsgLyogNTAlIC0gMy80IG9mIGljb24gaGVpZ2h0ICovXG4gIH1cbiAgXG4gIFxuICAjY29udGFpbmVyICoge1xuICAgICAgbWFyZ2luOiAwO1xuICAgICAgcGFkZGluZzogMDtcbiAgICB9XG4gICAgI2NvbnRhaW5lciB7XG4gICAgICB3aWR0aDogMTAwJTtcbiAgICAgIGZvbnQtc2l6ZTogMDtcbiAgICB9XG4gICAgI2xlZnQsXG4gICAgI21pZGRsZSxcbiAgICAjcmlnaHQge1xuICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgKmRpc3BsYXk6IGlubGluZTtcbiAgICAgIHpvb206IDE7XG4gICAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xuICAgIH1cbiAgICAjbGVmdCB7XG4gICAgICB3aWR0aDogMjUlO1xuICAgIH1cbiAgICAjbWlkZGxlIHtcbiAgICAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207XG4gICAgICB3aWR0aDogNjAlO1xuICAgIH1cbiAgICAjcmlnaHQge1xuICAgICAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgICAgIHdpZHRoOiAxNSU7XG4gICAgfSIsIi5sb2dvLWhlYWRlciB7XG4gIHdpZHRoOiAxNzBweDtcbiAgaGVpZ2h0OiBhdXRvO1xuICBkaXNwbGF5OiBibG9jaztcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gIG1hcmdpbi1yaWdodDogYXV0bztcbn1cblxuLmhlYWRlci1vbmUge1xuICAtLWJhY2tncm91bmQ6IHJnYmEoMjU1LCAyNTUsIDI1NSwgMC45KTtcbiAgYm94LXNoYWRvdzogMCA0cHggOHB4IDAgcmdiYSgwLCAwLCAwLCAwLjIpLCAwIDZweCAyMHB4IDAgcmdiYSgwLCAwLCAwLCAwLjE5KTtcbn1cblxuLmxvY2staW1nIHtcbiAgaGVpZ2h0OiBhdXRvICFpbXBvcnRhbnQ7XG4gIHdpZHRoOiBhdXRvICFpbXBvcnRhbnQ7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5cbmlvbi1pY29uIHtcbiAgZm9udC1zaXplOiA5MHB4O1xuICBjb2xvcjogIzAwNjE3MjtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIHRvcDogY2FsYyg1MCUgLSAxMHB4KTtcbiAgLyogNTAlIC0gMy80IG9mIGljb24gaGVpZ2h0ICovXG59XG5cbiNjb250YWluZXIgKiB7XG4gIG1hcmdpbjogMDtcbiAgcGFkZGluZzogMDtcbn1cblxuI2NvbnRhaW5lciB7XG4gIHdpZHRoOiAxMDAlO1xuICBmb250LXNpemU6IDA7XG59XG5cbiNsZWZ0LFxuI21pZGRsZSxcbiNyaWdodCB7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgKmRpc3BsYXk6IGlubGluZTtcbiAgem9vbTogMTtcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbn1cblxuI2xlZnQge1xuICB3aWR0aDogMjUlO1xufVxuXG4jbWlkZGxlIHtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgd2lkdGg6IDYwJTtcbn1cblxuI3JpZ2h0IHtcbiAgdmVydGljYWwtYWxpZ246IGJvdHRvbTtcbiAgd2lkdGg6IDE1JTtcbn0iXX0= */\";"]}