<ion-header>
  <ion-toolbar mode="ios">
    <ion-buttons slot="start">
      <ion-button (click)="close()">
        <ion-icon color="primary" name="chevron-back-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title class="toolbarTitle">{{'medical_calendar.header' | translate}}</ion-title>
    <ion-buttons slot="end">
      <ion-button color="primary" slot="end" (click)="save()">
        <ion-icon color="primary" name="checkmark-outline" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>


<ion-content>
  <ion-row class="textBlueCentered1, header-change-month">
    <!-- Move back one screen of the slides -->
    <ion-col size="2">
      <ion-button fill="clear" [disabled]="buttonAvailable" (click)="back()" class="textBlueCentered1">
        <ion-icon name="chevron-back-outline" slot="icon-only" color="primary"></ion-icon>
      </ion-button>
    </ion-col>
    <ion-col size="8" class="textBlue; textBlueCentered1">
      <h3 style="text-align: center;">{{ viewTitle | titlecase }}</h3>
    </ion-col>
    <ion-col size="2" class="textBlueCentered1">
      <ion-button fill="clear" (click)="next()">
        <ion-icon name="chevron-forward-outline" slot="icon-only" color="primary"></ion-icon>
      </ion-button>
    </ion-col>
  </ion-row>

  <calendar *ngIf="modalReady" [eventSource]="eventSource" [calendarMode]="calendar.mode"
   (onTitleChanged)="onViewTitleChanged($event)"
    (onEventSelected)="onEventSelected($event)" (onCurrentDateChanged)="onCurrentDateChanged($event)" startHour="6"
    endHour="20" step="30" [startingDayWeek]="this.dateService.getStartingDayWeek()"
    [monthviewDisplayEventTemplate]="template" [monthviewEventDetailTemplate]="monthviewDefaultEventDetailTemplate"
    [dateFormatter]="calendar.dateFormatter" (onTimeSelected)="onTimeSelected($event)" [markDisabled]="markDisabled"
    [startingDayMonth]="this.dateService.getStartingDayMonth()">
  </calendar>


  <ng-template #template let-view="view" let-row="row" let-col="col">
    <div class="dayWeek" [class.with-event]="view.dates[row*7+col].events.length">
      {{view.dates[row*7+col].label}}
    </div>
  </ng-template>

  <ng-template class="showDetail" #monthviewDefaultEventDetailTemplate let-showEventDetail="showEventDetail"
    let-selectedDate="selectedDate" let-noEventsLabel="noEventsLabel">

    <ion-row class="rowPadding"><ion-text color="primary" class="event-detail-title">{{
        formatSelectedDate(selectedDate.date) | uppercase}}</ion-text></ion-row>

    <ion-row class="blanco">
      <ng-container *ngIf="!routeResolveData ">
        <div style="padding: 20px 40px; text-align: center;">
          <ion-spinner ></ion-spinner>
        </div>
      </ng-container>
      <div *ngIf="routeResolveData">
        <div *ngIf="this.eventSource.length==0 else slots">
          <ion-grid>
            <ion-row>
              <ion-col size="1" class="iconNoDataRow">
                <ion-icon color="black" name="calendar-clear-outline"></ion-icon>
              </ion-col>
              <ion-col size="11">
                <p class="textMedium"> {{'medical_calendar.no_slot_available' | translate}}</p>
              </ion-col>
            </ion-row>
          </ion-grid>
        </div>

        <ng-template #slots class="blanco">
          <ng-container
            *ngFor="let item of this.eventSource | paginate: { itemsPerPage: 30, currentPage: page };let i = index">

            <ion-chip (click)="changeTagColor(item.id, i, item.startTime, item.duration )" [color]="tagDefaultColor[i]" [disabled]="item.isDisabled">
              <ion-label>{{ item.startTime | date:this.dateService.getTimeFormat() }} </ion-label>
            </ion-chip>
          </ng-container>
        </ng-template>
        <div *ngIf="this.timeSlots.length > 0" class="blanco">
          <ion-row style="margin-top: -3%; margin-left: 2%; margin-right: 2%">
            <div class="clearfix">
              <ion-col size="12" style="text-align: left">
                <pagination-controls (pageChange)="page = $event"
                  previousLabel="{{'medical_calendar.previousLabel' | translate}}"
                  nextLabel="{{'medical_calendar.nextLabel' | translate}}"></pagination-controls>
              </ion-col>
            </div>
          </ion-row>
        </div>
      </div>
    </ion-row>

  </ng-template>



</ion-content>