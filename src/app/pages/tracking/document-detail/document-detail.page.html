<ion-header>
  <ion-toolbar mode="ios">
    <ion-buttons slot="start">
      <ion-back-button text=""></ion-back-button>
    </ion-buttons>
    <ion-title>{{diagnosticTestType?.name}}</ion-title>
    <ion-buttons slot="end">
    <ion-button *ngIf="this.diagnosticTest?.addedByUser" (click)="editDiagnosticTest()" slot="end" fill="clear">
      <ion-icon name="create-outline"></ion-icon>
    </ion-button>
  </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content  fullscreen>

  <div class="spin" *ngIf="this.isLoading">
    <ion-spinner name="bubbles"></ion-spinner>
  </div>

  <ion-row>
    <ion-text class="txtTitle2">{{ 'documents.subtitle_information' | translate}}</ion-text>
  </ion-row>
  <ion-card class="cardProfile">
    <ion-list>
      <ion-item *ngIf="diagnosticTest.title !== null">
        <ion-label>{{ 'documents_add.field_title' | translate}}</ion-label>
        <ion-label class="textMedium">{{diagnosticTest.title}}</ion-label>
      </ion-item>
      <ion-item lines="none">
        <ion-label>{{ 'documents_add.field_date' | translate}}</ion-label>
        <ion-label *ngIf="diagnosticTest !== undefined" class="textMedium">{{formatSelectedDate(diagnosticTest.data) }}
        </ion-label>
      </ion-item>
    </ion-list>
  </ion-card>
  <ion-card class="cardProfile">
    <ion-list>
      <!-- <ion-item>
        <ion-label>{{ 'documents_add.field_description' | translate}}</ion-label>
        <ion-label class="textMedium">{{diagnosticTest?.description}}</ion-label>
      </ion-item>
      <ion-item >
        <ion-label>{{ 'documents_add.field_diagnostic' | translate}}</ion-label>
        <ion-label class="textMedium">{{diagnosticTest?.diagnostic}}</ion-label>
      </ion-item> -->

      <!-- description and diagnostic accordion start here-->

      <div (click)="expandItem(item)" *ngFor="let item of items| slice:0:1; let i = index" [attr.data-index]="i"
        class="cardProfile">

        <ion-item *ngIf="item.expanded" lines="none">
          <ion-label>{{ 'documents_add.field_description' | translate}}</ion-label>
          <ion-icon name="chevron-up-outline" slot="end" size="small"></ion-icon>
        </ion-item>
        <ion-item *ngIf="!item.expanded" lines="none">
          <ion-label>{{ 'documents_add.field_description' | translate}}</ion-label>
          <ion-icon name="chevron-down-outline" slot="end" size="small"></ion-icon>
        </ion-item>

        <!-- ACORDION -->
        <app-expandable expandHeight="100px" [expanded]="item.expanded">
          <ion-item>
            <ion-label class="textMedium">{{diagnosticTest?.description}}</ion-label>
          </ion-item>
        </app-expandable>

        <ion-item *ngIf="item.expanded" lines="none">
          <ion-label>{{ 'documents_add.field_diagnostic' | translate}}</ion-label>
          <ion-icon name="chevron-up-outline" slot="end" size="small"></ion-icon>
        </ion-item>
        <ion-item *ngIf="!item.expanded" lines="none">
          <ion-label>{{ 'documents_add.field_diagnostic' | translate}}</ion-label>
          <ion-icon name="chevron-down-outline" slot="end" size="small"></ion-icon>
        </ion-item>

        <!-- ACORDION -->
        <app-expandable expandHeight="100px" [expanded]="item.expanded">
          <ion-item>
            <ion-label class="textMedium">{{diagnosticTest?.diagnostic}}</ion-label>
          </ion-item>
        </app-expandable>
      </div>
      <ion-item *ngIf="diagnosticTest?.center_id">
        <ion-label>{{ 'documents_add.field_center' | translate}}</ion-label>
        <ion-label class="textMedium">{{'diagnosticTestType.center_id'}}</ion-label>
      </ion-item>
      <ion-item *ngIf="diagnosticTest?.specialty_id">
        <ion-label>{{ 'documents_add.field_specially' | translate}}</ion-label>
        <ion-label class="textMedium">{{'diagnosticTest.specialty_id'}}</ion-label>
      </ion-item>
      <ion-item lines="none" *ngIf="diagnosticTest?.idDoctor">
        <ion-label>{{ 'documents_add.field_prfesional' | translate}}</ion-label>
        <ion-label class="textMedium">{{'diagnosticTest.idDoctor'}}</ion-label>
      </ion-item>
    </ion-list>
  </ion-card>


  <!-- <ion-text class="txtTitle">{{ 'documents.subtitle_detail' | translate}}</ion-text> -->
  <ion-card (click)="expandItem(item)" *ngFor="let item of items" class="cardProfile">
    <div *ngIf="item.elements.elements.length > 0 ">
      <ion-item *ngIf="item.expanded" lines="none">
        <ion-label>{{item.elements.group}}</ion-label>
        <ion-icon name="chevron-up-outline" slot="end" size="small"></ion-icon>
      </ion-item>
      <ion-item *ngIf="!item.expanded" lines="none">
        <ion-label>{{item.elements.group}}</ion-label>
        <ion-icon name="chevron-down-outline" slot="end" size="small"></ion-icon>
      </ion-item>

      <!-- ACORDION -->
      <app-expandable expandHeight="100px" [expanded]="item.expanded">
        <ion-list *ngFor="let e of item.elements.elements">
          <ion-item>
            <ion-text>
              <p class="txtTitleTrackingLittle" style="color: black; font-size: 14px;">{{e.name}}</p>
            </ion-text>
            <ion-text slot="end">
              <p class="txtTitleTrackingLittle">{{e.value}}{{e.units}}</p>
              <!-- <p class="txtTitleTrackingLittle">{{e.date | date: 'dd/mm/yy'}}</p> -->
            </ion-text>
          </ion-item>
        </ion-list>
      </app-expandable>
    </div>
  </ion-card>

  <ion-row>
    <ion-text *ngIf="this.mediaFiles.length > 0" class="txtTitle2">{{ 'documents_add.attachments' |
      translate}}</ion-text>
  </ion-row>

  <ion-card class="cardProfile" *ngIf="this.mediaFiles.length > 0">

      <div id="container" style="margin-top: 20px; margin-bottom: 10px;">
        <div *ngFor="let file of this.mediaFiles; let i = index" class="section">
          <ion-item [lines]="(i === this.mediaFiles.length -1)? 'none':'full' ">
            <div id="left">
              <ion-icon name="open" color="primary" (click)="openFile(file)"></ion-icon>
            </div>
            <div id="middle">
              <p class="titule">{{ getName(file) }}</p>
            </div>
          </ion-item>
        </div>       
      </div>

  </ion-card>

</ion-content>