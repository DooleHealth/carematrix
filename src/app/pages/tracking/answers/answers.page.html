<ion-header>
  <ion-toolbar mode="ios">
    <ion-buttons slot="start">
      <ion-back-button text="" color="primary"></ion-back-button>
    </ion-buttons>
    <ion-title class="toolbarTitle">{{ 'answer_form.detail_answer' | translate}}</ion-title>
    <ion-buttons slot="end">
      <ion-icon size="large" class="primaryIcon" color="primary" slot="icon-only" name="menu-outline" routerLink="/profile"></ion-icon>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>

  <div class="spin" *ngIf="this.loadingForms">
   <ion-spinner ></ion-spinner>
  </div>
  <ion-row style="margin-top:5%; margin-bottom: 5%;">
    <ion-text  class="txtTitleBlueDark">{{title}}</ion-text>
  </ion-row>
  <ion-list *ngFor="let item of this.answers; let i = index">
    <ion-grid>
      <ion-row>
        <ion-text class="txtTitleGoals" [innerHtml]="this.removeImages(item?.question?.label) | safeHtml"></ion-text>
        <!-- <ion-text class="txtTitleGoals" >{{item?.question?.label}}</ion-text> -->
      </ion-row>
      <ion-row>
        <ion-card class="verticalCardBlue card">
          <div *ngIf="item.question.formFieldType == 'bioquimic' || item.question.formFieldType == 'slider' ||
              item.question.formFieldType == 'number'; else noData">
            <div *ngIf="item?.items.length > 0"  >
              <app-high-charts [widthScreen]="this.widthScreen" style="width: 100%;height: 450px" [minY]="item.question.bioquimic" [maxY]="item.question.bioquimic" [title]="item.question?.bioquimic_name" [data]="item.items" [id]="item.items[0].formFieldName" [units]="item.question?.bioquimic?.abbreviation"></app-high-charts>
            </div>

          </div>

          <ng-template #noData>

          <ion-item *ngIf="!item.expanded" (click)="item.expanded = true" lines="none">
            <ion-label class="textsize">{{ 'answer_form.response_history' | translate}}</ion-label>
            <ion-icon name="chevron-up-outline" slot="end" size="small"></ion-icon>
          </ion-item>
          <ion-item (click)="item.expanded = false" *ngIf="item.expanded" lines="none">
            <ion-text class="textsize" slot="start">{{ 'answer_form.date' | translate}}</ion-text>
            <ion-text class="textsize" slot="end">{{ 'answer_form.answer' | translate}}</ion-text>
            <ion-icon name="chevron-down-outline" slot="end" size="small"></ion-icon>
          </ion-item>

          <!-- ACORDION -->
          <app-expandable expandHeight="500px" [expanded]="item.expanded">
            <div scrolly="true" style="max-height:500px; max-width:1000px">
            <ion-list *ngFor="let e of item.items; let i = index">
                <ion-item style="margin-top: 5px;" [lines]="(i== item.items.length -1)? 'none':'full' ">
                  <ion-text slot="start" style="margin-top: 15px;">
                    <p class="txtTitleTrackingLittle" style="color: black; font-size: 14px;">{{formatDate(e.end_date)}}</p>
                  </ion-text>
                  <ion-text slot="end" style="margin-top: 15px;">
                    <p *ngIf="item.question.formFieldType !== 'date' && item.question.formFieldType !== 'file'" class="txtTitleTrackingLittle" [innerHtml]="e?.valueString| safeHtml"></p>
                    <p *ngIf="item.question.formFieldType == 'date'" class="txtTitleTrackingLittle">{{e.date_string}}</p>
                    <p *ngIf="item.question.formFieldType == 'file'" (click)="openMedia(e.file_url)" class="textBlue">{{'conversation.open_file' | translate}}</p>
                  </ion-text>

                </ion-item>
            </ion-list>
          </div>
          </app-expandable>

          </ng-template>

        </ion-card>
      </ion-row>
    </ion-grid>
  </ion-list>

</ion-content>
