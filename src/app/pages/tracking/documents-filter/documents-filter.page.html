<ion-header>
  <ion-toolbar mode="ios">
    <ion-buttons slot="start">
      <ion-back-button (click)="close()" text="" icon="close"></ion-back-button>
    </ion-buttons>
    <ion-title class="toolbarTitle">{{ 'documents_filter.header' | translate}}</ion-title>
    <ion-buttons slot="end">
      <ion-button  color="primary"
       (click)="submit()">
       <ion-icon name="checkmark-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- <ion-searchbar
  [animated]="true"
  (ionInput)="filterList($event)"
  placeholder="{{ 'Busca tu prueba' | translate}}">
</ion-searchbar> -->

<div class="spin" *ngIf="this.isLoading">
  <ion-spinner name="bubbles"></ion-spinner>
</div>

  <form (ngSubmit)="submit()" [formGroup]="form">
  <ion-item lines="none">
    <ion-text class="txtTitleNoMargin">{{ 'documents_add.field_date' | translate}}</ion-text>
    <ion-toggle slot="end" color="success" [checked]="toggle" (ionChange)='(toggle = ! toggle) ? toggle : !toggle; changeToggleDate($event)'></ion-toggle>
  </ion-item>
  <ion-card class="cardProfile" *ngIf="toggle">
    <ion-list>
      <ion-item>
        <ion-label  stacked>
            <h5 >{{'documents_filter.from' | translate}}</h5>
            <ion-note *ngIf="this.isSubmittedStartDate && this.form.get('start_date').invalid" (ionInput)="isSubmittedDuration = false" class="error " color="danger">{{ getErrorStartDate() }}</ion-note>
        </ion-label>
        <ion-datetime-button firstDayOfWeek="1" [ngStyle]="{'text-decoration': this.crossStartDate ? 'line-through' : 'none'}" slot="end" datetime="start_date"></ion-datetime-button>
      </ion-item>
      <ion-modal [keepContentsMounted]="true" [backdropDismiss]="false">
        <ng-template>
          <ion-datetime firstDayOfWeek="1" (ionChange)="this.isSubmittedStartDate = false; checkTreatmentDates()" [locale]="this.locale" presentation="date" id="start_date" [max]="this.currentDate" formControlName="start_date"></ion-datetime>
          <ion-buttons mode="ios" slot="buttons" style="background-color: white;">
            <ion-button class="btn-style-1" mode="ios" color="danger"  slot="start"></ion-button>
            <ion-button class="btn-style-1" mode="ios" style="width: 50px;"></ion-button>
            <ion-button class="btn-style-1" mode="ios" color="primary" slot="end" (click)="close();">{{'button.confirm' | translate}}</ion-button>
          </ion-buttons>
        </ng-template>
      </ion-modal>
              <!-- FIXME:: ionic 7 [displayFormat],placeholder removed-->
        <!-- <ion-datetime cancelText="{{'button.cancel' | translate}}" doneText="{{'button.accept' | translate}}" formControlName="start_date" [displayFormat]="this.dateService.getShortDateFormat()" placeholder=" {{  this.currentDate | date: 'dd/MM/YYYY' }} " min="1990-01-01" [max]="this.currentDate"></ion-datetime> -->


      <ion-item lines="none">
        <ion-label  stacked>
          <h5 >{{'documents_filter.until' | translate}}</h5>
          <ion-note *ngIf="this.isSubmittedDuration && this.form.get('end_date').invalid" (ionInput)="isSubmittedDuration = false"  class="error " color="danger">{{ getErrorEndDate() }}</ion-note>
        </ion-label>
        <ion-datetime-button firstDayOfWeek="1" [ngStyle]="{'text-decoration': this.crossEndDate ? 'line-through' : 'none'}" slot="end" datetime="end_date"></ion-datetime-button>
      </ion-item>
      <ion-modal [keepContentsMounted]="true" [backdropDismiss]="false">
        <ng-template>
          <ion-datetime firstDayOfWeek="1" (ionChange)="this.isSubmittedDuration = false; checkTreatmentDates2()" [locale]="this.locale" presentation="date" id="end_date" [max]="currentDate" formControlName="end_date"></ion-datetime>
          <ion-buttons mode="ios" slot="buttons" style="background-color: white;">
            <ion-button class="btn-style-1" mode="ios" color="danger"  slot="start"></ion-button>
            <ion-button class="btn-style-1" mode="ios" style="width: 50px;"></ion-button>
            <ion-button class="btn-style-1" mode="ios" color="primary" slot="end" (click)="close();">{{'button.confirm' | translate}}</ion-button>
          </ion-buttons>
        </ng-template>
      </ion-modal>

              <!-- FIXME:<ion-datetime cancelText="{{'button.cancel' | translate}}" doneText="{{'button.accept' | translate}}" formControlName="end_date" [displayFormat]="this.dateService.getShortDateFormat()" placeholder=" {{  this.currentDate | date: 'dd/MM/YYYY' }} " min="1990-01-01" [max]="this.currentDate"></ion-datetime> -->

    </ion-list>
  </ion-card>

  <ion-item lines="none">
    <ion-text class="txtTitleNoMargin">{{ 'documents_add.field_test_type' | translate}}</ion-text>
    <ion-toggle slot="end" color="success" [checked]="toggle2" (ionChange)='(toggle2 = ! toggle2) ? toggle2 : !toggle2; changeToggleTestType($event)'></ion-toggle>
  </ion-item>
  <ion-card class="cardProfile" *ngIf="toggle2">
    <ion-list *ngFor="let test of listTestType; let i = index">
      <ion-item [lines]="linesNone(i)">
        <ion-label>{{test.name}}</ion-label>
        <ion-checkbox slot="start" [checked]="test?.checked" (ionChange)="actionCheckboxTestType($event, test.id)"></ion-checkbox>
      </ion-item>
    </ion-list>
  </ion-card>
</form>
</ion-content>